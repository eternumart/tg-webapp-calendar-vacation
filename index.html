<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Ð’Ñ‹Ð±Ð¾Ñ€ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ð° Ð´Ð°Ñ‚</title>
		<script src="https://telegram.org/js/telegram-web-app.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
		<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
		<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
		<link rel="stylesheet" href="index.css" />
	</head>
	<body class="page">
		<h3 class="title">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½ Ð´Ð°Ñ‚</h3>
		<input class="calendar" type="text" id="calendar" />
		<button class="submit">Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ</button>

		<script>
			flatpickr(".calendar", {
				locale: "ru",
				dateFormat: "d.m.Y",
				mode: "range",
				inline: true,
			});

			const button = document.querySelector(".submit");
			button.addEventListener("click", sendDateRange);

			const tg = window.Telegram.WebApp;
			tg.ready();
			tg.expand();

			console.log("ðŸ§ª TG WebApp Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½", tg);
			console.log("ðŸ” initDataUnsafe:", tg.initDataUnsafe);

			function sendDateRange() {
				const dates = document.getElementById("calendar").value;
				if (!dates) return;

				const [startDate, endDate] = dates.split(" â€” ").map((date) => date.trim());

				const result = {
					startDate,
					endDate: endDate || startDate,
				};

				console.log("ðŸ“¤ ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ð° Ð´Ð°Ñ‚ Ð² Telegram:", result);
				tg.sendData(JSON.stringify(result));
				tg.close();
			}
		</script>
	</body>
</html>
